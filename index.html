<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>IPEC Catalog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root {
      --bg: #fafafa;
      --card: #fff;
      --text: #111;
      --muted: #6b7280;
      --accent: #0ea5e9;
      --bar-h: 56px;
      --radius: 14px;
      --gap: 14px;
      --shadow: 0 6px 20px rgba(0,0,0,.06);
      --ring: 0 0 0 2px rgba(14,165,233,.25);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background: var(--bg);
      -webkit-tap-highlight-color: transparent;
      /* Leave room for sticky bar on older iOS while it animates */
      padding-top: 0;
    }

    /* CATEGORY BAR */
    .category-bar-wrap {
      position: sticky; /* better with iOS URL bar than fixed */
      top: 0;
      z-index: 1000;
    }
    .category-bar {
      height: var(--bar-h);
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 14px;
      background: #fff;
      border-bottom: 1px solid rgba(0,0,0,.06);
      transform: translateY(0);
      transition: transform .22s ease;
      will-change: transform;
      contain: layout paint;
      /* For iOS notch devices */
      padding-top: calc(env(safe-area-inset-top, 0px));
    }
    .category-bar.is-hidden { transform: translateY(calc(-100% - env(safe-area-inset-top, 0px))); }

    .cat-chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: #f1f5f9;
      color: #0f172a;
      text-decoration: none;
      font-weight: 600;
      white-space: nowrap;
      touch-action: manipulation;
      border: 1px solid rgba(0,0,0,.05);
    }
    .cat-chip:focus-visible { outline: none; box-shadow: var(--ring); }
    .cat-chip.active { background: #e0f2fe; color: #075985; border-color: rgba(14,165,233,.35); }

    /* LAYOUT */
    main { padding: 16px; }
    .grid {
      display: grid;
      gap: var(--gap);
      grid-template-columns: repeat(1, minmax(0, 1fr));
    }
    @media (min-width: 540px) { .grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (min-width: 900px) { .grid { grid-template-columns: repeat(3, minmax(0, 1fr)); } }
    @media (min-width: 1200px) { .grid { grid-template-columns: repeat(4, minmax(0, 1fr)); } }

    /* CARD */
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid rgba(0,0,0,.05);
      display: flex;
      flex-direction: column;
    }
    .thumb {
      display: block; /* ensure whole image is a tap target */
      width: 100%;
      aspect-ratio: 4/3;
      background: #f3f4f6;
      position: relative;
      overflow: hidden;
      touch-action: manipulation;
    }
    .thumb img {
      width: 100%;
      height: 100%;
      object-fit: contain; /* avoids accidental overlays */
      display: block;
      pointer-events: auto;
    }
    .meta {
      padding: 12px 12px 14px;
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 8px;
    }
    .title {
      font-weight: 700;
      font-size: 14px;
    }
    .code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      color: var(--muted);
      font-size: 12px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,.08);
      background: #fff;
      text-decoration: none;
      color: #0f172a;
      font-weight: 600;
      gap: 8px;
      touch-action: manipulation;
    }
    .btn:focus-visible { outline: none; box-shadow: var(--ring); }
    .btn.primary { background: #0ea5e9; color: white; border-color: #0ea5e9; }

    /* Ensure no invisible overlay blocks taps */
    .card, .card *, .category-bar, .category-bar * { pointer-events: auto; }

    /* Make anchor targets nicely big on mobile */
    a { -webkit-touch-callout: none; touch-action: manipulation; }
  </style>
</head>
<body>

  <!-- CATEGORY BAR -->
  <div class="category-bar-wrap">
    <nav class="category-bar" role="navigation" aria-label="Categories">
      <a class="cat-chip active" href="#all">All</a>
      <a class="cat-chip" href="#cooking">Cooking</a>
      <a class="cat-chip" href="#refrigeration">Refrigeration</a>
      <a class="cat-chip" href="#prep">Preparation</a>
      <a class="cat-chip" href="#display">Display</a>
    </nav>
  </div>

  <!-- CONTENT -->
  <main id="content">
    <section class="grid" id="productGrid">

      <!-- CARD TEMPLATE (duplicate and replace with your real data) -->
      <article class="card" data-cat="cooking">
        <!-- Wrap IMAGE with the SPEC SHEET LINK -->
        <a class="thumb spec-link" href="https://example.com/specs/TKF-OVN90.pdf" target="_blank" rel="noopener">
          <img src="https://via.placeholder.com/800x600?text=OVN90" alt="Convection Oven OVN90" loading="lazy">
        </a>
        <div class="meta">
          <div>
            <div class="title">Convection Oven</div>
            <div class="code">TKF-OVN90</div>
          </div>
          <a class="btn" href="https://example.com/specs/TKF-OVN90.pdf" target="_blank" rel="noopener" aria-label="Open specification sheet">Spec Sheet</a>
        </div>
      </article>

      <article class="card" data-cat="refrigeration">
        <a class="thumb spec-link" href="https://example.com/specs/TKSA-TTR15080D.pdf" target="_blank" rel="noopener">
          <img src="https://via.placeholder.com/800x600?text=TTR15080D" alt="Static Cooling Cabinet TKSA-TTR15080D" loading="lazy">
        </a>
        <div class="meta">
          <div>
            <div class="title">Static Cooling Cabinet</div>
            <div class="code">TKSA-TTR15080D</div>
          </div>
          <a class="btn" href="https://example.com/specs/TKSA-TTR15080D.pdf" target="_blank" rel="noopener">Spec Sheet</a>
        </div>
      </article>

      <article class="card" data-cat="prep">
        <a class="thumb spec-link" href="https://example.com/specs/TKF-MIX20.pdf" target="_blank" rel="noopener">
          <img src="https://via.placeholder.com/800x600?text=MIX20" alt="Planetary Mixer MIX20" loading="lazy">
        </a>
        <div class="meta">
          <div>
            <div class="title">Planetary Mixer</div>
            <div class="code">TKF-MIX20</div>
          </div>
          <a class="btn" href="https://example.com/specs/TKF-MIX20.pdf" target="_blank" rel="noopener">Spec Sheet</a>
        </div>
      </article>

      <article class="card" data-cat="display">
        <a class="thumb spec-link" href="https://example.com/specs/TKF-HOTDPL120.pdf" target="_blank" rel="noopener">
          <img src="https://via.placeholder.com/800x600?text=HOTDPL120" alt="Hot Display 120" loading="lazy">
        </a>
        <div class="meta">
          <div>
            <div class="title">Hot Display</div>
            <div class="code">TKF-HOTDPL120</div>
          </div>
          <a class="btn" href="https://example.com/specs/TKF-HOTDPL120.pdf" target="_blank" rel="noopener">Spec Sheet</a>
        </div>
      </article>

    </section>
  </main>

  <script>
    (function () {
      // ----- Category Bar hide/show (mobile-safe) -----
      const bar = document.querySelector('.category-bar');
      let lastY = window.scrollY || 0;
      let ticking = false;
      const THRESHOLD = 2; // avoid jitter from iOS URL bar collapse/expand

      function onScrollFrame() {
        const y = window.scrollY || 0;
        const dy = y - lastY;

        if (Math.abs(dy) > THRESHOLD) {
          if (dy > 0) {
            // Scrolling DOWN -> hide
            bar.classList.add('is-hidden');
          } else {
            // Scrolling UP -> show IMMEDIATELY
            bar.classList.remove('is-hidden');
          }
          lastY = y;
        }
        ticking = false;
      }

      function onScroll() {
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(onScrollFrame);
        }
      }

      window.addEventListener('scroll', onScroll, { passive: true });

      // iOS Safari: visual viewport changes can happen without window scroll
      if (window.visualViewport) {
        visualViewport.addEventListener('scroll', onScroll, { passive: true });
        visualViewport.addEventListener('resize', onScroll, { passive: true });
      }

      // ----- Category filtering (optional; keep if you use the chips) -----
      const grid = document.getElementById('productGrid');
      const chips = document.querySelectorAll('.cat-chip');

      function setActiveChip(el) {
        chips.forEach(c => c.classList.toggle('active', c === el));
      }
      function filterByHash(hash) {
        const cat = (hash || '#all').replace('#', '');
        setActiveChip([...chips].find(c => c.getAttribute('href') === '#' + cat) || chips[0]);
        const cards = grid.querySelectorAll('.card');
        cards.forEach(card => {
          const ok = (cat === 'all') || (card.dataset.cat === cat);
          card.style.display = ok ? '' : 'none';
        });
      }
      window.addEventListener('hashchange', () => filterByHash(location.hash));
      filterByHash(location.hash);

      // ----- Tap reliability for image links -----
      // Ensure no global preventDefault on touchstart blocks navigation
      document.addEventListener('touchstart', function(e){ /* passive: true */ }, { passive: true });

      // If any ancestor has click handlers, stop them from canceling link navigation
      document.querySelectorAll('a.spec-link').forEach(a => {
        a.addEventListener('click', function(ev) {
          // Let the anchor do its default thing. Avoid JS navigation to prevent iOS quirks.
          // If you previously used ev.preventDefault() somewhere, remove it.
        }, { passive: true });
      });

      // ----- (Optional) Cache-bust helper: append ?v=2 to assets if needed -----
      // Example usage if you dynamically inject images/specs; here we’re static.
    })();
  </script>
</body>
</html>
